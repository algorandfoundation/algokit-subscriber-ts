<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>README | @algorandfoundation/algokit-subscriber</title><meta name="description" content="Documentation for @algorandfoundation/algokit-subscriber"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">@algorandfoundation/algokit-subscriber</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="" aria-current="page">README</a></li></ul></div><div class="tsd-panel tsd-typography"><h1 id="algorand-transaction-subscription-indexing" class="tsd-anchor-link">Algorand transaction subscription / indexing<a href="#algorand-transaction-subscription-indexing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This library a simple, but flexible / configurable Algorand transaction subscription / indexing mechanism. It allows you to quickly create Node.js or JavaScript services that follow or subscribe to the Algorand Blockchain.</p>
<h2 id="install" class="tsd-anchor-link">Install<a href="#install" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Before installing, you'll need to decide on the version you want to target. Version 2 and 3 have largerly the same feature set, however v2 leverages algosdk@&gt;=2.9.0&lt;3.0, whereas v3 leverages algosdk@&gt;=3.0.0. It is recommended that you aim to target the latest version, however in some circumstances that might not be possible.</p>
<p>Once you've decided on the target version, this library can be installed from NPM using your favourite npm client, e.g.:</p>
<p>To target algosdk@2 and use version 2 of AlgoKit Subscriber, run the below:</p>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">install</span><span class="hl-1"> </span><span class="hl-0">algosdk</span><span class="hl-1">@^</span><span class="hl-2">2.10</span><span class="hl-1">.</span><span class="hl-2">0</span><span class="hl-1"> @</span><span class="hl-0">algorandfoundation</span><span class="hl-1">/</span><span class="hl-0">algokit</span><span class="hl-1">-</span><span class="hl-0">utils</span><span class="hl-1">@^</span><span class="hl-2">7.1</span><span class="hl-1">.</span><span class="hl-2">0</span><span class="hl-1"> @</span><span class="hl-0">algorandfoundation</span><span class="hl-1">/</span><span class="hl-0">algokit</span><span class="hl-1">-</span><span class="hl-0">subscriber</span><span class="hl-1">@^</span><span class="hl-2">2.2</span><span class="hl-1">.</span><span class="hl-2">0</span>
</code><button>Copy</button></pre>

<p>To target algosdk@3 and use the latest version of AlgoKit Subscriber, run the below:</p>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">install</span><span class="hl-1"> </span><span class="hl-0">algosdk</span><span class="hl-1">@^</span><span class="hl-2">3.1</span><span class="hl-1">.</span><span class="hl-2">0</span><span class="hl-1"> @</span><span class="hl-0">algorandfoundation</span><span class="hl-1">/</span><span class="hl-0">algokit</span><span class="hl-1">-</span><span class="hl-0">utils</span><span class="hl-1"> @</span><span class="hl-0">algorandfoundation</span><span class="hl-1">/</span><span class="hl-0">algokit</span><span class="hl-1">-</span><span class="hl-0">subscriber</span>
</code><button>Copy</button></pre>

<h2 id="migration" class="tsd-anchor-link">Migration<a href="#migration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Whilst we aim to minimise breaking changes, there are situations where they are required.</p>
<p>If you're migrating from an older version to v3, please refer to the <a href="v3-migration.html">v3 migration guide</a>.</p>
<h2 id="quick-start" class="tsd-anchor-link">Quick start<a href="#quick-start" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-3">// Create subscriber</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">subscriber</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">AlgorandSubscriber</span><span class="hl-1">(</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-0">filters:</span><span class="hl-1"> [</span><br/><span class="hl-1">      {</span><br/><span class="hl-1">        </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-7">&#39;filter1&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-0">filter:</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-0">TransactionType</span><span class="hl-1">.</span><span class="hl-0">pay</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-0">sender:</span><span class="hl-1"> </span><span class="hl-7">&#39;ABC...&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">    </span><span class="hl-3">/* ... other options (use intellisense to explore) */</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">algod</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">optionalIndexer</span><span class="hl-1">,</span><br/><span class="hl-1">)</span><br/><br/><span class="hl-3">// Set up subscription(s)</span><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-7">&#39;filter1&#39;</span><span class="hl-1">, </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-0">transaction</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">// ...</span><br/><span class="hl-1">})</span><br/><span class="hl-3">//...</span><br/><br/><span class="hl-3">// Set up error handling</span><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">onError</span><span class="hl-1">((</span><span class="hl-0">e</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">// ...</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// Either: Start the subscriber (if in long-running process)</span><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">()</span><br/><br/><span class="hl-3">// OR: Poll the subscriber (if in cron job / periodic lambda)</span><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">pollOnce</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<h2 id="key-features" class="tsd-anchor-link">Key features<a href="#key-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Notification <em>and</em> indexing</strong> - You have fine-grained control over the syncing behaviour and can control the number of rounds to sync at a time, the pattern of syncing i.e. start from the beginning of the chain, or start from the tip; drop stale records if your service can't keep up or keep syncing from where you are up to; etc.</li>
<li><strong>Low latency processing</strong> - When your service has caught up to the tip of the chain it can optionally wait for new rounds so you have a low latency reaction to a new round occurring</li>
<li><strong>Watermarking and resilience</strong> - You can create reliable syncing / indexing services through a simple round watermarking capability that allows you to create resilient syncing services that can recover from an outage</li>
<li><strong>Extensive subscription filtering</strong> - You can filter by transaction type, sender, receiver, note prefix, apps (ID, creation, on complete, ARC-4 method signature, call arguments, ARC-28 events), assets (ID, creation, amount transferred range), transfers (amount transferred range) and balance changes (algo and assets)</li>
<li><strong>ARC-28 event subscription support</strong> - You can subscribe to ARC-28 events for a smart contract, similar to how you can <a href="https://docs.web3js.org/guides/events_subscriptions/">subscribe to events in Ethereum</a></li>
<li><strong>Balance change support</strong> - Subscribed transactions will have all algo and asset balance changes calculated for you and you can also subscribe to balance changes that meet certain criteria</li>
<li><strong>First-class inner transaction support</strong> - Your filter will find arbitrarily nested inner transactions and return that transaction (indexer can't do this!)</li>
<li><strong>State-proof support</strong> - You can subscribe to state proof transactions</li>
<li><strong>Simple programming model</strong> - It's really easy to use and consume through easy to use, type-safe TypeScript methods and objects and subscribed transactions have a comprehensive and familiar model type with all relevant/useful information about that transaction (including things like transaction id, round number, created asset/app id, app logs, etc.) modelled on the indexer data model (which is used regardless of whether the transactions come from indexer or algod so it's a consistent experience)</li>
<li><strong>Easy to deploy</strong> - You have full control over how you want to deploy and use the subscriber; it will work with whatever persistence (e.g. sql, no-sql, etc.), queuing/messaging (e.g. queues, topics, buses, web hooks, web sockets) and compute (e.g. serverless periodic lambdas, continually running containers, virtual machines, etc.) services you want to use</li>
<li><strong>Fast initial index</strong> - There is an indexer catch up mode that allows you to use indexer to catch up to the tip of the chain in seconds or minutes rather than days; alternatively, if you prefer to just use algod and not indexer that option is available too!</li>
</ul>
<h2 id="balance-change-notes" class="tsd-anchor-link">Balance change notes<a href="#balance-change-notes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The balance change semantics work mostly as expected, however the sematics around asset creation and destruction warrants further clarification.</p>
<p>When an asset is created, the full asset supply is attributed to the asset creators account.</p>
<p>The balance change for an asset create transaction will be as below:</p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-8">&quot;address&quot;</span><span class="hl-1">: </span><span class="hl-7">&quot;VIDHG4SYANCP2GUQXXSFSNBPJWS4TAQSI3GH4GYO54FSYPDIBYPMSF7HBY&quot;</span><span class="hl-1">, </span><span class="hl-3">// The asset creator</span><br/><span class="hl-1">  </span><span class="hl-8">&quot;assetId&quot;</span><span class="hl-1">: </span><span class="hl-2">2391</span><span class="hl-9">n</span><span class="hl-1">, </span><span class="hl-3">// The created asset id</span><br/><span class="hl-1">  </span><span class="hl-8">&quot;amount&quot;</span><span class="hl-1">: </span><span class="hl-2">100000</span><span class="hl-9">n</span><span class="hl-1">, </span><span class="hl-3">// Full asset supply of the created asset</span><br/><span class="hl-1">  </span><span class="hl-8">&quot;roles&quot;</span><span class="hl-1">: [</span><span class="hl-7">&quot;AssetCreator&quot;</span><span class="hl-1">]</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>When an asset is destroyed, the full asset supply must be in the asset creators account and the asset manager must send the destroy transaction.
Unfortunately we cannot determine the asset creator or full asset supply from the transaction data. As a result the balance change will always be attributed to the asset manager and will have a 0 amount.
If you need to account for the asset supply being destroyed from the creators account, you'll need to handle this separately.</p>
<p>The balance change for an asset destroy transaction will be as below:</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;address&quot;</span><span class="hl-1">: </span><span class="hl-7">&quot;PIDHG4SYANCP2GUQXXSFSNBPJWS4TAQSI3GH4GYO54FSYPDIBYPMSF7HBY&quot;</span><span class="hl-1">, </span><span class="hl-3">// The asset destroyer, which will always be the asset manager</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;assetId&quot;</span><span class="hl-1">: </span><span class="hl-2">2391</span><span class="hl-4">n</span><span class="hl-1">, </span><span class="hl-3">// The destroyed asset id</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;amount&quot;</span><span class="hl-1">: </span><span class="hl-2">0</span><span class="hl-4">n</span><span class="hl-1">, </span><span class="hl-3">// This value will always be 0</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;roles&quot;</span><span class="hl-1">: [</span><span class="hl-7">&quot;AssetDestroyer&quot;</span><span class="hl-1">]</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="examples" class="tsd-anchor-link">Examples<a href="#examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="data-history-museum-index" class="tsd-anchor-link">Data History Museum index<a href="#data-history-museum-index" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The following code, when algod is pointed to TestNet, will find all transactions emitted by the <a href="https://datahistory.org">Data History Museum</a> since the beginning of time in <em>seconds</em> and then find them in real-time as they emerge on the chain.</p>
<p>The watermark is stored in-memory so this particular example is not resilient to restarts. To change that you can implement proper persistence of the watermark. There is <a href="../media/index.ts">an example that uses the file system</a> to demonstrate this.</p>
<pre><code class="typescript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">algorand</span><span class="hl-1"> = </span><span class="hl-0">AlgorandClient</span><span class="hl-1">.</span><span class="hl-6">fromEnvironment</span><span class="hl-1">()</span><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-0">watermark</span><span class="hl-1"> = </span><span class="hl-2">0</span><span class="hl-4">n</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">subscriber</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">AlgorandSubscriber</span><span class="hl-1">(</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-0">events:</span><span class="hl-1"> [</span><br/><span class="hl-1">      {</span><br/><span class="hl-1">        </span><span class="hl-0">eventName:</span><span class="hl-1"> </span><span class="hl-7">&#39;dhm-asset&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-0">filter:</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-0">TransactionType</span><span class="hl-1">.</span><span class="hl-0">acfg</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-3">// Data History Museum creator account on TestNet</span><br/><span class="hl-1">          </span><span class="hl-0">sender:</span><span class="hl-1"> </span><span class="hl-7">&#39;ER7AMZRPD5KDVFWTUUVOADSOWM4RQKEEV2EDYRVSA757UHXOIEKGMBQIVU&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">    </span><span class="hl-0">frequencyInSeconds:</span><span class="hl-1"> </span><span class="hl-2">5</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">maxRoundsToSync:</span><span class="hl-1"> </span><span class="hl-2">100</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">syncBehaviour:</span><span class="hl-1"> </span><span class="hl-7">&#39;catchup-with-indexer&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">watermarkPersistence:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">get</span><span class="hl-0">:</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-0">watermark</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">set</span><span class="hl-0">:</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-0">newWatermark</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">watermark</span><span class="hl-1"> = </span><span class="hl-0">newWatermark</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">algorand</span><span class="hl-1">.</span><span class="hl-0">client</span><span class="hl-1">.</span><span class="hl-0">algod</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">algorand</span><span class="hl-1">.</span><span class="hl-0">client</span><span class="hl-1">.</span><span class="hl-0">indexer</span><span class="hl-1">,</span><br/><span class="hl-1">)</span><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">onBatch</span><span class="hl-1">(</span><span class="hl-7">&#39;dhm-asset&#39;</span><span class="hl-1">, </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-0">events</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-7">`Received </span><span class="hl-4">${</span><span class="hl-0">events</span><span class="hl-10">.</span><span class="hl-0">length</span><span class="hl-4">}</span><span class="hl-7"> asset changes`</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-3">// ... do stuff with the events</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">onError</span><span class="hl-1">((</span><span class="hl-0">e</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">// eslint-disable-next-line no-console</span><br/><span class="hl-1">  </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">error</span><span class="hl-1">(</span><span class="hl-0">e</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<h3 id="usdc-real-time-monitoring" class="tsd-anchor-link">USDC real-time monitoring<a href="#usdc-real-time-monitoring" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The following code, when algod is pointed to MainNet, will find all transfers of <a href="https://www.circle.com/en/usdc-multichain/algorand">USDC</a> that are greater than $1 and it will poll every 1s for new transfers.</p>
<pre><code class="typescript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">algorand</span><span class="hl-1"> = </span><span class="hl-0">AlgorandClient</span><span class="hl-1">.</span><span class="hl-6">fromEnvironment</span><span class="hl-1">()</span><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-0">watermark</span><span class="hl-1"> = </span><span class="hl-2">0</span><span class="hl-4">n</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">subscriber</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">AlgorandSubscriber</span><span class="hl-1">(</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-0">events:</span><span class="hl-1"> [</span><br/><span class="hl-1">      {</span><br/><span class="hl-1">        </span><span class="hl-0">eventName:</span><span class="hl-1"> </span><span class="hl-7">&#39;usdc&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-0">filter:</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-0">TransactionType</span><span class="hl-1">.</span><span class="hl-0">axfer</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-0">assetId:</span><span class="hl-1"> </span><span class="hl-2">31566704</span><span class="hl-4">n</span><span class="hl-1">, </span><span class="hl-3">// MainNet: USDC</span><br/><span class="hl-1">          </span><span class="hl-0">minAmount:</span><span class="hl-1"> </span><span class="hl-2">1_000_000</span><span class="hl-4">n</span><span class="hl-1">, </span><span class="hl-3">// $1</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">    </span><span class="hl-0">waitForBlockWhenAtTip:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">syncBehaviour:</span><span class="hl-1"> </span><span class="hl-7">&#39;skip-sync-newest&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">watermarkPersistence:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">get</span><span class="hl-0">:</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-0">watermark</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">set</span><span class="hl-0">:</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-0">newWatermark</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">watermark</span><span class="hl-1"> = </span><span class="hl-0">newWatermark</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">algorand</span><span class="hl-1">.</span><span class="hl-0">client</span><span class="hl-1">.</span><span class="hl-0">algod</span><span class="hl-1">,</span><br/><span class="hl-1">)</span><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-7">&#39;usdc&#39;</span><span class="hl-1">, (</span><span class="hl-0">transfer</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">// eslint-disable-next-line no-console</span><br/><span class="hl-1">  </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">`</span><span class="hl-4">${</span><span class="hl-0">transfer</span><span class="hl-10">.</span><span class="hl-0">sender</span><span class="hl-4">}</span><span class="hl-7"> sent </span><span class="hl-4">${</span><span class="hl-0">transfer</span><span class="hl-10">.</span><span class="hl-0">assetTransferTransaction</span><span class="hl-10">?.</span><span class="hl-0">receiver</span><span class="hl-4">}</span><span class="hl-7"> USDC$</span><span class="hl-4">${</span><span class="hl-6">Number</span><span class="hl-10">(</span><br/><span class="hl-10">      (</span><span class="hl-0">transfer</span><span class="hl-10">.</span><span class="hl-0">assetTransferTransaction</span><span class="hl-10">?.</span><span class="hl-0">amount</span><span class="hl-10"> </span><span class="hl-1">??</span><span class="hl-10"> </span><span class="hl-2">0</span><span class="hl-4">n</span><span class="hl-10">) </span><span class="hl-1">/</span><span class="hl-10"> </span><span class="hl-2">1_000_000</span><span class="hl-4">n</span><span class="hl-10">,</span><br/><span class="hl-10">    ).</span><span class="hl-6">toFixed</span><span class="hl-10">(</span><span class="hl-2">2</span><span class="hl-10">)</span><span class="hl-4">}</span><span class="hl-7"> in transaction </span><span class="hl-4">${</span><span class="hl-0">transfer</span><span class="hl-10">.</span><span class="hl-0">id</span><span class="hl-4">}</span><span class="hl-7">`</span><span class="hl-1">,</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">onError</span><span class="hl-1">((</span><span class="hl-0">e</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">// eslint-disable-next-line no-console</span><br/><span class="hl-1">  </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">error</span><span class="hl-1">(</span><span class="hl-0">e</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-0">subscriber</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<h2 id="getting-started" class="tsd-anchor-link">Getting started<a href="#getting-started" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>To try examples in this repository:</p>
<ul>
<li><code>npm install</code></li>
<li>Copy <code>.env.sample</code> to <code>.env</code> and edit to point to the Algorand node you want</li>
<li><code>npm run dhm</code> or F5 in Visual Studio Code to get breakpoint debugging against one of the examples (or choose another)</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#algorand-transaction-subscription-indexing"><span>Algorand transaction subscription / indexing</span></a><ul><li><a href="#install"><span>Install</span></a></li><li><a href="#migration"><span>Migration</span></a></li><li><a href="#quick-start"><span>Quick start</span></a></li><li><a href="#key-features"><span>Key features</span></a></li><li><a href="#balance-change-notes"><span>Balance change notes</span></a></li><li><a href="#examples"><span>Examples</span></a></li><li><ul><li><a href="#data-history-museum-index"><span>Data <wbr/>History <wbr/>Museum index</span></a></li><li><a href="#usdc-real-time-monitoring"><span>USDC real-<wbr/>time monitoring</span></a></li></ul></li><li><a href="#getting-started"><span>Getting started</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">@algorandfoundation/algokit-subscriber</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
